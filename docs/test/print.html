<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Cardano Deposit Wallet (test)</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Intro</a></li><li class="chapter-item expanded "><a href="specifications.html"><strong aria-hidden="true">1.</strong> Specifications</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="usage.html"><strong aria-hidden="true">3.</strong> Usage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="usage/installation.html"><strong aria-hidden="true">3.1.</strong> Installation</a></li></ol></li><li class="chapter-item expanded "><a href="examples.html"><strong aria-hidden="true">4.</strong> Examples</a></li><li class="chapter-item expanded "><a href="api.html"><strong aria-hidden="true">5.</strong> API</a></li><li class="chapter-item expanded "><a href="contributing.html"><strong aria-hidden="true">6.</strong> Contributing</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Cardano Deposit Wallet (test)</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>TODO</p>
<div style="break-before: page; page-break-before: always;"></div><p>TODO</p>
<div style="break-before: page; page-break-before: always;"></div><p>TODO</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="status"><a class="header" href="#status">Status</a></h2>
<p>At the moment the project is in the early stages of development. To try it out you need
to use it as part of the cardano-wallet project.
<a href="https://github.com/cardano-foundation/cardano-wallet">Here</a> you can find the cardano-wallet project.
Critically:</p>
<ul>
<li>the executable is still not able to persist the wallet state</li>
<li>the REST API is not complete
On the other hand to prove the concept you can access a web-UI which uses the
exact same code that the REST API will use.
Regarding persistence, in case of positive feedback, we will implement an early
inefficient solution so that it became usable soon and prepare an efficient database
solution for the future.
Only linux and macos are supported at the moment. So for windows users, you can try
the project using WSL2.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<h3 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h3>
<p>This is a full node experience, so all caveats of running a full node apply.</p>
<p>In particular, for <code>mainnet</code> you will need:</p>
<ul>
<li>24 GB RAM (UTxO set is still in memory)</li>
<li>250 GB disk space (Transaction history is stored in full)</li>
<li>4 CPU cores (for syncing)</li>
</ul>
<p>But for <code>preprod</code> you can get away with:</p>
<ul>
<li>2 GB RAM</li>
<li>5 GB disk space</li>
<li>2 CPU cores</li>
</ul>
<h3 id="using-the-released-bundle"><a class="header" href="#using-the-released-bundle">Using the Released Bundle</a></h3>
<p>The released code is available in the cardano-wallet project. I will outline the
Linux instructions for preprod here. Little changes are needed for macOS.</p>
<p>You will need some tools:</p>
<ul>
<li>jq</li>
<li>wget</li>
<li>tar</li>
<li>screen</li>
<li>a working browser</li>
</ul>
<p>Nixers can run a shell with all the tools:</p>
<pre><code class="language-bash">nix-shell -p jq wget gnutar screen
</code></pre>
<blockquote>
<p>ATM there is no release do you have to build the wallet with nix in the cardano-wallet project.
ATM the repository is private so you have to clone it and build it locally.</p>
</blockquote>
<pre><code class="language-bash">
nix build .#linux-package -o ./result

```bash
# install the deposit wallet
LATEST_RELEASE=0.0.1
# LATEST_RELEASE=$(curl -s https://api.github.com/repos/cardano-foundation/cardano-deposit/wallet/releases/latest | jq -r .tag_name)
WALLET_NAME=cardano-deposit-wallet-$LATEST_RELEASE-linux64
# wget -q "https://github.com/cardano-foundation/cardano-deposit-wallet/releases/download/$LATEST_RELEASE/$WALLET_NAME.tar.gz"
ls -la result
tar xvzf "./result/$WALLET_NAME.tar.gz" --remove-files &gt; /dev/null
ls -la .
WALLET_DIR=$(pwd)
export WALLET_DIR
export PATH="$WALLET_DIR:$PATH"
NODE_CONFIGS="$WALLET_DIR/configs/preprod"
export NODE_CONFIGS
# end of install the deposit wallet
</code></pre>
<p>You will need to start the node and the wallet. It's recommended to retrieve the
node state from Mithril to avoid long waiting times.</p>
<p>Download the Mithril executable:</p>
<pre><code class="language-bash"># install mithril
LATEST_MITHRIL=$(curl -s https://api.github.com/repos/input-output-hk/mithril/releases/latest | jq -r .tag_name)
MITHRIL_NAME=mithril-$LATEST_MITHRIL-linux-x64
wget -q https://github.com/input-output-hk/mithril/releases/download/$LATEST_MITHRIL/$MITHRIL_NAME.tar.gz
MITHRIL_DIR=$(pwd)/$MITHRIL_NAME
mkdir -p "$MITHRIL_DIR"
tar xvzf "$MITHRIL_NAME.tar.gz" -C "$MITHRIL_DIR" --remove-files &gt; /dev/null
export PATH="$MITHRIL_DIR:$PATH"
# end of install mithril
</code></pre>
<p>Create a directory for the node state:</p>
<pre><code class="language-bash"># set up the node database directory
NODE_DB=$(pwd)/node-db
export NODE_DB
mkdir -p "$NODE_DB"
rm -rf "$NODE_DB/preprod"
# end of set up the node database directory
</code></pre>
<p>Populate it via Mithril:</p>
<blockquote>
<p>NixOS will refuse to run Mithril unless <code>programs.nix-ld.enable = true;</code> is in the configuration.</p>
</blockquote>
<pre><code class="language-bash"># populate the node database with the latest preprod snapshot
export AGGREGATOR_ENDPOINT=https://aggregator.release-preprod.api.mithril.network/aggregator
export GENESIS_VERIFICATION_KEY=5b3132372c37332c3132342c3136312c362c3133372c3133312c3231332c3230372c3131372c3139382c38352c3137362c3139392c3136322c3234312c36382c3132332c3131392c3134352c31332c3233322c3234332c34392c3232392c322c3234392c3230352c3230352c33392c3233352c34345d
digest=$(mithril-client cdb snapshot list --json | jq -r .[0].digest)
(cd "${NODE_DB}" &amp;&amp; mithril-client cdb download "$digest" &amp;&amp; mv db preprod)
# end of populate the node database with the latest preprod snapshot
</code></pre>
<p>Now you can start the node that comes bundled with the wallet. I am using <code>screen</code>
to keep the node running in the background.</p>
<pre><code class="language-bash"># start the node
screen -dmS node-session cardano-node run \
    --config "$NODE_CONFIGS/config.json" \
    --database-path "$NODE_DB/preprod" \
    --socket-path "$NODE_DB/preprod/node.socket" \
    --topology "$NODE_CONFIGS/topology.json"
# end of start the node
</code></pre>
<p>You can observe the node logs with:</p>
<pre><code class="language-bash">screen -r node-session
</code></pre>
<p>Detach from the screen with <code>Ctrl-a d</code>.</p>
<p>Now you can start the wallet:</p>
<pre><code class="language-bash"># start the deposit wallet
DEPOSIT_PORT=$(shuf -i 1024-65000 -n 1)
export DEPOSIT_PORT
LEGACY_PORT=$(shuf -i 1024-65000 -n 1)
screen -dmS wallet-session cardano-wallet serve \
    --node-socket "$NODE_DB/preprod/node.socket" \
    --testnet "$NODE_CONFIGS/byron-genesis.json" \
    --ui-deposit-port "$DEPOSIT_PORT" \
    --port "$LEGACY_PORT"
# end of start the deposit wallet
</code></pre>
<blockquote>
<p>ATM the legacy port is required even if we are not using it. Once the deposit
wallet is extracted from the wallet, the legacy port will be removed.</p>
</blockquote>
<p>You can observe the wallet logs with:</p>
<pre><code class="language-bash">screen -r wallet-session
</code></pre>
<p>Detach from the screen with <code>Ctrl-a d</code>.</p>
<p>Now you can connect to the web UI with:</p>
<pre><code class="language-bash">xdg-open http://localhost:$DEPOSIT_PORT
</code></pre>
<p>Clean up the screen sessions with:</p>
<pre><code class="language-bash"># remove screen sessions
screen -S node-session -X quit
screen -S wallet-session -X quit
# end of remove screen sessions
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><p>TODO</p>
<div style="break-before: page; page-break-before: always;"></div><p>API is not yet active.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
